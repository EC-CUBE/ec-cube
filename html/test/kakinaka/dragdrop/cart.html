ï»?!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0032)http://demo.script.aculo.us/shop -->
<HTML lang=en xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>script.aculo.us - web 2.0 javascript demos</TITLE>
<META http-equiv=content-type content="text/html; charset=utf-8"><LINK 
media=screen href="dragdrop.files/script.aculo.us.css" type=text/css 
rel=Stylesheet>
<SCRIPT src="dragdrop.files/prototype.js" type=text/javascript></SCRIPT>

<SCRIPT src="dragdrop.files/effects.js" type=text/javascript></SCRIPT>

<SCRIPT src="dragdrop.files/dragdrop.js" type=text/javascript></SCRIPT>

<SCRIPT src="dragdrop.files/controls.js" type=text/javascript></SCRIPT>

<STYLE type=text/css>DIV.auto_complete {
	BORDER-RIGHT: #888 1px solid; PADDING-RIGHT: 0px; BORDER-TOP: #888 1px solid; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; BORDER-LEFT: #888 1px solid; WIDTH: 250px; PADDING-TOP: 0px; BORDER-BOTTOM: #888 1px solid; POSITION: absolute; BACKGROUND-COLOR: white
}
UL.contacts {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px; LIST-STYLE-TYPE: none
}
UL.contacts LI.selected {
	BACKGROUND-COLOR: #ffb
}
LI.contact {
	PADDING-RIGHT: 2px; DISPLAY: block; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; MARGIN: 0px; PADDING-TOP: 2px; LIST-STYLE-TYPE: none; HEIGHT: 32px
}
LI.contact DIV.image {
	FLOAT: left; WIDTH: 32px; MARGIN-RIGHT: 8px; HEIGHT: 32px
}
LI.contact DIV.name {
	FONT-WEIGHT: bold; FONT-SIZE: 12px; LINE-HEIGHT: 1.2em
}
LI.contact DIV.email {
	FONT-SIZE: 10px; COLOR: #888
}
#list {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 10px 0px 0px; WIDTH: 250px; PADDING-TOP: 0px; LIST-STYLE-TYPE: none
}
#list LI {
	BORDER-RIGHT: #888 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #888 1px solid; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; MARGIN: 0px 0px 4px; BORDER-LEFT: #888 1px solid; CURSOR: move; PADDING-TOP: 5px; BORDER-BOTTOM: #888 1px solid
}
</STYLE>

<META content="MSHTML 6.00.2900.2873" name=GENERATOR></HEAD>
<BODY>
<DIV id=header><IMG id=logo alt="script.aculo.us - web 2.0 javascript demos" 
src="dragdrop.files/logo.gif"> </DIV>
<UL id=menu>
  <LI><A href="http://script.aculo.us/">Back to site</A> </LI>
  <LI><A class=active href="http://demo.script.aculo.us/">Demos</A> </LI></UL>
<DIV id=tagline>This site demonstrates the <B>Ruby on Rails 0.13</B> AJAX 
helpers, <BR>which use script.aculo.us effects, drag-and-drop and 
autocompletion. </DIV>
<DIV id=sidebar-container>
<DIV id=sidebar>
<H1>rails 0.13 Demos</H1>
<P>script.aculo.us helpers</P>
<UL>
  <LI><A href="http://demo.script.aculo.us/ajax/autocompleter">Autocompleting 
  text fields (basic)</A> 
  <LI><A 
  href="http://demo.script.aculo.us/ajax/autocompleter_customized">Autocompleting 
  text fields (customized)</A> 
  <LI><A href="http://demo.script.aculo.us/shop">Shopping cart</A> 
  <LI><A href="http://demo.script.aculo.us/ajax/sortable_elements">Sortable 
  elements</A> </LI></UL>
<P>New AJAX features</P>
<UL>
  <LI><A href="http://demo.script.aculo.us/ajax/error_handling">Error 
  handling</A> 
  <LI><A href="http://demo.script.aculo.us/ajax/update_element">Update element 
  helper</A> </LI></UL></DIV>
<DIV class=links><A href="http://www.rubyonrails.org/"><IMG alt="Ruby on Rails" 
src="dragdrop.files/rails.jpg"></A> <EM>Rails is a full-stack, open-source web 
framework in Ruby for writing real-world applications with joy and less code 
than most frameworks spend doing XML sit-ups.</EM> That quite sums it up. So, if 
you're still working late hours writing definitions of what's in your database 
because the framework you use works against and not for you -- do yourself a 
favour, and check out <A href="http://www.rubyonrails.org/">Ruby on Rails</A>. 
</DIV></DIV>
<DIV id=content>
<H1>Silly easy shopping</H1>
<P>Drag products to the cart to fill it:</P>
<DIV style="MARGIN-BOTTOM: 20px; HEIGHT: 120px"><IMG class=products id=product_1 
alt=Mug src="dragdrop.files/product1.png">
<SCRIPT type=text/javascript>new Draggable('product_1', {revert:true})</SCRIPT>
 <IMG class=products id=product_2 alt=T-Shirt src="dragdrop.files/product2.png">
<SCRIPT type=text/javascript>new Draggable('product_2', {revert:true})</SCRIPT>
 </DIV>
<H2>Your cart:</H2>
<DIV class=cart id=cart style="CLEAR: left; MARGIN-TOP: 10px; HEIGHT: 132px">
<DIV id=items>Here's your shopping cart. We would very much appreciate it if you 
fill it with stuff. </DIV>
<DIV style="CLEAR: both"></DIV></DIV>
<DIV id=wastebin>Drop items here to remove them from the cart. </DIV>
<DIV style="PADDING-TOP: 10px; HEIGHT: 40px">
<P id=indicator style="MARGIN-TOP: 0px; DISPLAY: none"><IMG alt=Indicator 
src="dragdrop.files/indicator.gif"> Updating cart... </P></DIV>
<SCRIPT type=text/javascript>Droppables.add('cart', {accept:'products', onDrop:function(element){new Ajax.Updater('items', '/shop/add', {onLoading:function(request){Element.show('indicator')}, onComplete:function(request){Element.hide('indicator')}, parameters:'id=' + encodeURIComponent(element.id), evalScripts:true, asynchronous:true})}, hoverclass:'cart-active'})</SCRIPT>

<SCRIPT type=text/javascript>Droppables.add('wastebin', {accept:'cart-items', onDrop:function(element){Element.hide(element); new Ajax.Updater('items', '/shop/remove', {onLoading:function(request){Element.show('indicator')}, onComplete:function(request){Element.hide('indicator')}, parameters:'id=' + encodeURIComponent(element.id), evalScripts:true, asynchronous:true})}, hoverclass:'wastebin-active'})</SCRIPT>

<P><A onclick="new Effect.SlideDown('source'); return false;" href="http://demo.script.aculo.us/shop#">View source</A></P><PRE id=source style="DISPLAY: none"><CODE>
# view
&lt;div style="margin-bottom:20px;height:120px;"&gt;
&lt;% for product in @products %&gt;
  &lt;%= image_tag "/images/products/product#{product.id}",
        :id =&gt; "product_#{product.id}",
        :alt =&gt; product.title, 
        :class =&gt; "products"  %&gt;
  &lt;%= draggable_element "product_#{product.id}", :revert =&gt; true %&gt;
&lt;% end %&gt;
&lt;/div&gt;

&lt;h2&gt;Your cart:&lt;/h2&gt;

&lt;div id="cart" class="cart" style="clear:left; height:132px;margin-top:10px;"&gt;
  &lt;div id="wastebin"&gt;
    Drop items here to remove them from the cart.
  &lt;/div&gt;
  &lt;div id="items"&gt;
    &lt;%= render :partial =&gt; "cart" %&gt;
  &lt;/div&gt;
  &lt;div style="clear:both;"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;div style="height:40px;padding-top:10px;"&gt;
&lt;p id="indicator" style="display:none;margin-top:0px;"&gt;
  &lt;%= image_tag "indicator.gif" %&gt; Updating cart...
&lt;/p&gt;
&lt;/div&gt;

&lt;%= drop_receiving_element "cart", 
      :update =&gt; "items", :url =&gt; { :action =&gt; "add" },
      :accept =&gt; "products", :hoverclass =&gt; "cart-active",
      :loading =&gt; "Element.show('indicator')",
      :complete =&gt; "Element.hide('indicator')" %&gt;
      
&lt;%= drop_receiving_element "wastebin", 
      :update =&gt; "items", :url =&gt; { :action =&gt; "remove" },
      :accept =&gt; "cart-items", :hoverclass =&gt; "wastebin-active",
      :before =&gt; "Element.hide(element)",
      :loading =&gt; "Element.show('indicator')",
      :complete =&gt; "Element.hide('indicator')" %&gt;
    
# controller
class ShopController &lt; ApplicationController
  
  def index
    session[:cart] ||= {}
    @products = Product.find(:all)
  end
  
  def add
    product_id = params[:id].split("_")[1]
    
    session[:cart][product_id] = 
      session[:cart].include?(product_id) ?  
      session[:cart][product_id]+1 : 1
  
    render :partial =&gt; 'cart'
  end
  
  def remove
    product_id = params[:id].split("_")[1]
    
    if session[:cart][product_id] &gt; 1 
      session[:cart][product_id] = session[:cart][product_id]-1
    else
      session[:cart].delete(product_id)
    end
    
    render :partial =&gt; 'cart'
  end
  
end


# _cart.rhtml partial
&lt;% session[:cart].each do |product,quantity| %&gt;
&lt;div&gt;
  &lt;% quantity.times do |i| %&gt;
    &lt;%= image_tag "/images/products/product#{product}", 
          :class =&gt; "cart-items", 
          :id =&gt; "item_#{product}_#{i}", 
          :style =&gt; "position:relative;" %&gt;
    &lt;%= draggable_element "item_#{product}_#{i}", :revert =&gt; true %&gt;
  &lt;% end %&gt;
  &lt;span class="title"&gt;
    &lt;%= Product.find(product).title + " (#{quantity})" %&gt;
  &lt;/span&gt;
&lt;/div&gt;
&lt;% end %&gt;
&lt;%= "Here's your shopping cart." if session[:cart].empty? %&gt;
</CODE></PRE></DIV>
<DIV id=footer>
<P>Â© 2005 Thomas Fuchs <A 
onclick="new Effect.BlindDown('license'); return false;" 
href="http://demo.script.aculo.us/shop#">License</A> <A 
href="http://validator.w3.org/check?uri=referer">validate</A> <A 
href="http://mir.aculo.us/">mir.aculo.us</A> </P>
<P class=info><A href="http://script.aculo.us/">script.aculo.us</A> demo site 
version <EM>2005/07/04</EM> </P>
<DIV id=license style="DISPLAY: none"><PRE>      script.aculo.us:
      
      Copyright (c) 2005 Thomas Fuchs (http://script.aculo.us, http://mir.aculo.us)
      
      Permission is hereby granted, free of charge, to any person obtaining
      a copy of this software and associated documentation files (the
      "Software"), to deal in the Software without restriction, including
      without limitation the rights to use, copy, modify, merge, publish,
      distribute, sublicense, and/or sell copies of the Software, and to
      permit persons to whom the Software is furnished to do so, subject to
      the following conditions:
      
      The above copyright notice and this permission notice shall be
      included in all copies or substantial portions of the Software.
      
      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
      MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
      NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
      LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
      OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
      WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
      
      <A onclick="new Effect.BlindUp('license'); return false;" href="http://demo.script.aculo.us/shop#">Hide</A>
      </PRE></DIV></DIV></BODY></HTML>
