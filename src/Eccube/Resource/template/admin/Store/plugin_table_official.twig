{#
This file is part of EC-CUBE

Copyright(c) LOCKON CO.,LTD. All Rights Reserved.

http://www.lockon.co.jp/

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
#}
{% if Plugins|length > 0 %}
    <div class="card-body p-0">
        <table class="table table-sm">
            <thead>
            <tr>
                <th class="border-top-0 pl-3 pt-2 pb-2">{{ 'admin.store.plugin_table_official.901'|trans }}</th>
                <th class="border-top-0 pt-2 pb-2">{{ 'admin.store.unregisterd_plugin_table.942'|trans }}</th>
                <th class="border-top-0 pt-2 pb-2">{{ 'admin.store.unregisterd_plugin_table.943'|trans }}</th>
                <th class="border-top-0 pt-2 pb-2">{{ 'admin.store.plugin_table.901'|trans }}</th>
                <th class="border-top-0 pt-2 pb-2">{{ 'admin.store.plugin_table_official.905'|trans }}</th>
                <th class="border-top-0 pt-2 pb-2">&nbsp;</th>
            </tr>
            </thead>
            <tbody>
            {% for key,Plugin in Plugins %}
                {% set pluginDetail = officialPluginsDetail[key]|default(NULL) %}
                <tr class="{% if Plugin.enabled == false %}active{% endif %}">
                    <td class="align-middle pl-3">
                        <a href="#" target="_blank" class="plugin-image pr-3">
                            <img height="60" src="{{ pluginDetail ? pluginDetail.image : asset('noimage_plugin_list.png', 'save_image') }}" alt="">
                        </a>
                        <span>{{ Plugin.name }}</span>
                    </td>
                    <td class="align-middle" style="width: 136px">{{ Plugin.version }}</td>
                    <td class="align-middle"><p class="mb-0">{{ Plugin.code }}</p>
                        {# TODO: readme of plugin #}
                        {#{% if attribute(app.config[Plugin.code].const, 'readme') is defined %}
                            <a href="#" class="view_readme" data-toggle="modal" data-target="#readmeModal"
                               data-name="{{ Plugin.name }}"
                               data-readme="{{ attribute(app.config[Plugin.code].const, 'readme') }}">{{ 'admin.store.unregisterd_plugin_table.948'|trans }}</a>
                        {% endif %}#}
                    </td>
                    <td class="align-middle">
                        {% if Plugin.id %}
                            {% if Plugin.enabled %}
                                <span class="text-success">{{ 'common.label.enabled'|trans }}</span>
                            {% else %}
                                <span class="text-secondary">{{ 'common.label.disabled'|trans }}</span>
                            {% endif %}
                        {% endif %}
                    </td>
                    <td class="align-middle">
                        {% if Plugin.id and pluginDetail %}
                            {% if pluginDetail.update_status == 1 %}
                                <a href="{{ url('admin_store_plugin_update_confirm', {'id': Plugin.id}) }}"
                                   class="btn btn-ec-regular">{{ 'admin.store.plugin_table_official.916'|trans }}</a>
                                <ul class="plugin-meta dl-horizontal">
                                    <li class="plugin-version">{{ 'admin.store.plugin_table_official.917'|trans({'%version%' : pluginDetail.version}) }}</li>
                                    <li class="plugin-version">
                                        {% set versions = '' %}
                                        {% for version in pluginDetail.supported_versions %}
                                            {% set versions = versions ~ version %}
                                            {%- if loop.last == false%}{% set versions = versions ~ ',' %}{% endif -%}
                                        {% endfor %}
                                        {{ 'admin.store.plugin_table_official.918'|trans({'%versions%' : versions}) }}
                                    </li>
                                    <li class="plugin-update">{{ 'admin.store.plugin_table_official.919'|trans({'%update_date%' : pluginDetail.update_date|time_ago}) }}</li>
                                </ul>
                            {% else %}
                                <p class="mb-0">{{ 'admin.store.plugin_table_official.920'|trans }}。</p>
                            {% endif %}
                        {% endif %}
                    </td>
                    <td class="align-middle">
                        {% if Plugin.id %}
                            <div class="col-12 col-xs-11 col-md-10 col-lg-8 pull-right text-center">
                                <div class="row">
                                    <div class="col-4 px-0">
                                        {% if Plugin.enabled == false %}
                                            <a href="#"
                                               data-toggle="modal"
                                               data-target="#confirmModal-{{ Plugin.id }}"
                                               class="btn btn-ec-actionIcon">
                                                <i class="fa fa-close fa-lg text-secondary" data-tooltip="true" data-placement="top" title="{{ 'admin.common.delete'|trans }}"></i>
                                            </a>

                                            <div class="modal fade" id="confirmModal-{{ Plugin.id }}" tabindex="-1"
                                                 role="dialog"
                                                 aria-labelledby="confirmModal-{{ Plugin.id }}" aria-hidden="true">
                                                <div class="modal-dialog" role="document">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title font-weight-bold">
                                                                {{ 'admin.store.plugin.popup.delete.confirm.title'|trans }}</h5>
                                                            <button class="close" type="button"
                                                                    data-dismiss="modal"
                                                                    aria-label="Close"><span aria-hidden="true">×</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body text-left">
                                                            <p class="text-left">
                                                                {{ 'admin.store.plugin.popup.delete.confirm.message'|trans }}</p>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button class="btn btn-ec-sub" type="button"
                                                                    data-dismiss="modal">{{ 'admin.common.cancel'|trans }}
                                                            </button>
                                                            <a href="{{ url('admin_store_plugin_delete_confirm', { id : Plugin.id }) }}"
                                                                    {{ csrf_token_for_anchor() }}
                                                               class="btn btn-ec-delete"
                                                               data-confirm="false"
                                                               data-method="delete">
                                                                {{ 'admin.common.delete'|trans }}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endif %}
                                    </div>
                                    <div class="col-4 px-0">
                                        {% if Plugin.enabled %}
                                            <a href="{{ url('admin_store_plugin_disable', { id : Plugin.id }) }}" {{ csrf_token_for_anchor() }}
                                               class="btn btn-ec-actionIcon"
                                               data-method="put" data-confirm="false">
                                                <i class="fa fa-pause fa-lg text-secondary" data-tooltip="true"
                                                   data-placement="top" title="{{ 'admin.store.plugin_table_official.925'|trans }}"></i>
                                            </a>
                                        {% else %}
                                            <a href="{{ url('admin_store_plugin_enable', { id : Plugin.id }) }}" {{ csrf_token_for_anchor() }}
                                               class="btn btn-ec-actionIcon"
                                               data-method="put" data-confirm="false">
                                                <i class="fa fa-play fa-lg text-secondary" data-tooltip="true"
                                                   data-placement="top" title="{{ 'admin.store.plugin_table_official.924'|trans }}"></i>
                                            </a>
                                        {% endif %}
                                    </div>
                                    <div class="col-4 pl-0">
                                        {% if configPages[Plugin.code] is defined %}
                                            <a class="btn btn-ec-actionIcon" href="{{ configPages[Plugin.code] }}">
                                                <i class="fa fa-cog fa-lg text-secondary" data-tooltip="true"
                                                   data-placement="top" title="{{ 'admin.store.plugin_table_official.906'|trans }}"></i>
                                            </a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    {% if officialPluginsDetail|length == 0 %}
    <p class="ml-3">{{ 'admin.store.plugin.help'|trans }}</p>
    {% endif %}
{% else %}
    <div class="card-body">
        <div class="text-danger">
            {{ 'admin.store.plugin_table_official.923'|trans }}
        </div>
    </div>
{% endif %}